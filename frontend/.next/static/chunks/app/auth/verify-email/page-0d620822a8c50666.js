(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[270],{1128:(e,t,a)=>{Promise.resolve().then(a.bind(a,1392))},1392:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(5155),s=a(2115),o=a(6874),n=a.n(o),i=a(5695),l=a(7182);function c(){let e=(0,i.useSearchParams)(),[t,a]=(0,s.useState)("loading"),[o,c]=(0,s.useState)("");(0,s.useEffect)(()=>{let t=e.get("token");t?u(t):(a("error"),c("Verification token is missing. Please use the link from your email."))},[e]);let{verifyEmail:d}=(0,l.A)(),u=async e=>{try{await d(e),a("success")}catch(e){console.error("Email verification error:",e),a("error"),e instanceof Error?c(e.message):c("Failed to verify your email. The link may have expired.")}},h=async()=>{try{window.location.href="/auth/check-email"}catch(e){console.error("Resend verification error:",e)}};return(0,r.jsx)("div",{className:"min-h-screen flex flex-col justify-center items-center bg-gradient-to-b from-gray-900 to-gray-800 px-4",children:(0,r.jsxs)("div",{className:"w-full max-w-md bg-gray-800 border border-gray-700 rounded-xl shadow-xl p-8 text-center",children:["loading"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-900/30 mb-6",children:(0,r.jsxs)("svg",{className:"animate-spin w-8 h-8 text-blue-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Verifying Your Email"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Please wait while we verify your email address..."})]}),"success"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-900/30 mb-6",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Email Verified!"}),(0,r.jsx)("p",{className:"text-gray-400 mb-6",children:"Your email has been successfully verified. You can now sign in to your account."}),(0,r.jsx)(n(),{href:"/auth/login",className:"inline-block bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-lg px-6 py-2 font-medium",children:"Sign In"})]}),"error"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-red-900/30 mb-6",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Verification Failed"}),(0,r.jsx)("p",{className:"text-red-400 mb-4",children:o}),(0,r.jsx)("p",{className:"text-gray-400 mb-6",children:"The verification link may have expired or is invalid. Please try requesting a new verification email."}),(0,r.jsx)("button",{onClick:h,className:"inline-block bg-gray-700 hover:bg-gray-600 text-white rounded-lg px-6 py-2 font-medium",children:"Resend Verification Email"})]})]})})}function d(){return(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen flex flex-col justify-center items-center bg-gradient-to-b from-gray-900 to-gray-800 px-4",children:(0,r.jsxs)("div",{className:"w-full max-w-md bg-gray-800 border border-gray-700 rounded-xl shadow-xl p-8 text-center",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-900/30 mb-6",children:(0,r.jsxs)("svg",{className:"animate-spin w-8 h-8 text-blue-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Loading..."}),(0,r.jsx)("p",{className:"text-gray-400",children:"Please wait while we process your request..."})]})}),children:(0,r.jsx)(c,{})})}},2302:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let r=a(3464).A.create({baseURL:"http://localhost:3000",headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>(e.response&&401===e.response.status&&(localStorage.removeItem("token"),window.location.pathname.includes("/auth/login")||(window.location.href="/auth/login")),Promise.reject(e)));let s=r},5327:(e,t,a)=>{"use strict";a.d(t,{ZQ:()=>s,_R:()=>o,bX:()=>n});var r=a(2302);let s={login:async e=>(await r.A.post("/auth/login",e)).data,register:async e=>(await r.A.post("/auth/register",e)).data,verifyEmail:async e=>(await r.A.get("/auth/verify-email?token=".concat(e))).data,resendVerification:async e=>(await r.A.post("/auth/resend-verification",{email:e})).data,forgotPassword:async e=>(await r.A.post("/auth/forgot-password",{email:e})).data,resetPassword:async e=>(await r.A.post("/auth/reset-password",e)).data,getCurrentUser:async()=>(await r.A.get("/user/profile")).data,logout:async()=>{localStorage.removeItem("token")},googleLogin:()=>{window.location.href="".concat("http://localhost:3000","/auth/google")},handleGoogleCallback:e=>{localStorage.setItem("token",e),window.location.href="/dashboard"}};var o=function(e){return e.FANTASY="fantasy",e.MODERN="modern",e.SCIFI="scifi",e.XIANXIA="xianxia",e.WUXIA="wuxia",e.HORROR="horror",e.CYBERPUNK="cyberpunk",e.STEAMPUNK="steampunk",e.POSTAPOCALYPTIC="postapocalyptic",e.HISTORICAL="historical",e}({});let n={createCharacter:async e=>(await r.A.post("/game/characters",e)).data,generateCharacter:async e=>(await r.A.post("/game/characters/generate",e)).data,getCharacters:async()=>(await r.A.get("/game/characters")).data,getCharacterById:async e=>(await r.A.get("/game/characters/".concat(e))).data,getAvailableGenres:async()=>(await r.A.get("/game/genres")).data,startNewGame:async e=>(await r.A.post("/game/sessions",{characterId:e})).data,getGameSessions:async()=>(await r.A.get("/game/sessions")).data,getGameSession:async e=>(await r.A.get("/game/sessions/".concat(e))).data,saveGame:async e=>(await r.A.put("/game/sessions/".concat(e,"/save"))).data,endGame:async e=>(await r.A.put("/game/sessions/".concat(e,"/end"))).data,makeChoice:async(e,t)=>(await r.A.post("/game/sessions/".concat(e,"/choices/").concat(t))).data,processUserInput:async(e,t)=>(await r.A.post("/game/sessions/".concat(e,"/input"),t)).data}},5541:(e,t,a)=>{"use strict";a.d(t,{u:()=>s});var r=a(3464);function s(e){if(r.A.isAxiosError(e)){if(e.response){let t=e.response.data;return t.message?t.message:"Error ".concat(e.response.status,": ").concat(e.response.statusText)}return e.request&&!e.response?"Network error. Please check your internet connection and try again.":e.message}return e instanceof Error?e.message:"An unknown error occurred. Please try again."}},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},7182:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,O:()=>l});var r=a(5155),s=a(2115),o=a(5327),n=a(5541);let i=(0,s.createContext)(void 0),l=e=>{let{children:t}=e,[a,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(!0),[u,h]=(0,s.useState)(null);(0,s.useEffect)(()=>{localStorage.getItem("token")?g():d(!1);let e=new URLSearchParams(window.location.search).get("token");"/auth/google-callback"===window.location.pathname&&e&&o.ZQ.handleGoogleCallback(e)},[]);let g=async()=>{try{d(!0);let e=await o.ZQ.getCurrentUser();l(e),h(null)}catch(e){console.error("Failed to fetch user profile:",e),h("Session expired. Please login again."),localStorage.removeItem("token")}finally{d(!1)}},m=async e=>{try{d(!0);let t=await o.ZQ.login(e);localStorage.setItem("token",t.access_token),await g(),h(null)}catch(e){throw console.error("Login failed:",e),h((0,n.u)(e)),e}finally{d(!1)}},w=async e=>{try{d(!0);let t=await o.ZQ.register(e);return h(null),t.message}catch(e){throw console.error("Registration failed:",e),h((0,n.u)(e)),e}finally{d(!1)}},f=async e=>{try{d(!0);let t=await o.ZQ.verifyEmail(e);return h(null),t.message}catch(e){throw console.error("Email verification failed:",e),h((0,n.u)(e)),e}finally{d(!1)}},x=async e=>{try{d(!0);let t=await o.ZQ.resendVerification(e);return h(null),t.message}catch(e){throw console.error("Failed to resend verification email:",e),h((0,n.u)(e)),e}finally{d(!1)}},y=async e=>{try{d(!0);let t=await o.ZQ.forgotPassword(e);return h(null),t.message}catch(e){throw console.error("Failed to process forgot password request:",e),h((0,n.u)(e)),e}finally{d(!1)}},p=async e=>{try{d(!0);let t=await o.ZQ.resetPassword(e);return h(null),t.message}catch(e){throw console.error("Failed to reset password:",e),h((0,n.u)(e)),e}finally{d(!1)}};return(0,r.jsx)(i.Provider,{value:{user:a,isLoading:c,isAuthenticated:!!a&&a.isActive,error:u,login:m,register:w,logout:()=>{o.ZQ.logout(),l(null),h(null),window.location.href="/auth/login"},verifyEmail:f,resendVerification:x,forgotPassword:y,resetPassword:p,googleLogin:()=>{o.ZQ.googleLogin()}},children:t})},c=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[464,874,441,684,358],()=>t(1128)),_N_E=e.O()}]);