(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{455:(e,s,t)=>{Promise.resolve().then(t.bind(t,9690))},1489:(e,s,t)=>{"use strict";t.d(s,{AuthProvider:()=>c,A:()=>n});var r=t(5155),a=t(2115);let l=async()=>{try{let e=await fetch("/api/auth/status",{method:"GET",credentials:"include"});if(e.ok)return await e.json();return{isAuthenticated:!1}}catch(e){return console.error("Error checking auth status:",e),{isAuthenticated:!1}}},i=(0,a.createContext)(void 0),n=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},c=e=>{let{children:s}=e,[t,n]=(0,a.useState)(!1),[c,d]=(0,a.useState)(null),[o,h]=(0,a.useState)(!0),u=async()=>{try{h(!0);let e=await l();n(e.isAuthenticated),d(e.user||null)}catch(e){console.error("Error checking authentication:",e),n(!1),d(null)}finally{h(!1)}};return(0,a.useEffect)(()=>{u()},[]),(0,r.jsx)(i.Provider,{value:{isAuthenticated:t,user:c,loading:o,checkAuth:u},children:s})}},9690:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>h});var r=t(5155),a=t(2115),l=t(5695),i=t(6874),n=t.n(i),c=t(3464),d=t(1489);function o(){let e=(0,l.useRouter)(),s=(0,l.useSearchParams)().get("redirect")||"/game",{isAuthenticated:t,loading:i,checkAuth:o}=(0,d.A)(),[h,u]=(0,a.useState)({email:"",password:""}),[m,x]=(0,a.useState)(!1),[g,b]=(0,a.useState)("");(0,a.useEffect)(()=>{t&&e.push(s)},[t,e,s]);let f=e=>{let{name:s,value:t}=e.target;u({...h,[s]:t})},j=async e=>{e.preventDefault();try{x(!0),b(""),await c.A.post("/api/auth/login",h),await o()}catch(e){var s,t;console.error("Login error:",e),b((null==(t=e.response)||null==(s=t.data)?void 0:s.message)||"Đăng nhập thất bại. Vui l\xf2ng thử lại."),x(!1)}};return i||t?(0,r.jsx)("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-pulse text-2xl font-bold mb-4",children:t?"Đang chuyển hướng...":"Đang kiểm tra..."}),(0,r.jsx)("div",{className:"w-12 h-12 border-t-4 border-blue-500 border-solid rounded-full animate-spin mx-auto"})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 to-blue-900 text-white flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"max-w-md w-full",children:[(0,r.jsx)("div",{className:"bg-gray-800 rounded-xl shadow-lg overflow-hidden",children:(0,r.jsxs)("div",{className:"p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Đăng Nhập"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Đăng nhập để bắt đầu cuộc phi\xeau lưu của bạn"})]}),g&&(0,r.jsx)("div",{className:"mb-6 p-3 bg-red-900/50 text-red-200 rounded-lg",children:g}),(0,r.jsxs)("form",{onSubmit:j,children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-gray-300 mb-2",children:"Email"}),(0,r.jsx)("input",{type:"email",id:"email",name:"email",value:h.email,onChange:f,className:"w-full bg-gray-700 text-white rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nhập email của bạn",required:!0})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,r.jsx)("label",{htmlFor:"password",className:"text-gray-300",children:"Mật khẩu"}),(0,r.jsx)(n(),{href:"/forgot-password",className:"text-blue-400 hover:text-blue-300 transition-colors text-sm",children:"Qu\xean mật khẩu?"})]}),(0,r.jsx)("input",{type:"password",id:"password",name:"password",value:h.password,onChange:f,className:"w-full bg-gray-700 text-white rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nhập mật khẩu của bạn",required:!0})]}),(0,r.jsx)("button",{type:"submit",disabled:m,className:"w-full py-3 rounded-lg text-white font-bold transition-colors ".concat(m?"bg-blue-700 cursor-wait":"bg-blue-600 hover:bg-blue-700"),children:m?(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang đăng nhập..."]}):"Đăng nhập"})]}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsxs)("p",{className:"text-gray-400",children:["Chưa c\xf3 t\xe0i khoản?"," ",(0,r.jsx)(n(),{href:"/register",className:"text-blue-400 hover:text-blue-300 transition-colors",children:"Đăng k\xfd ngay"})]})}),(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,r.jsx)("div",{className:"w-full border-t border-gray-700"})}),(0,r.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,r.jsx)("span",{className:"px-2 bg-gray-800 text-gray-400",children:"Hoặc đăng nhập với"})})]}),(0,r.jsx)("div",{className:"mt-6 grid grid-cols-1 gap-3",children:(0,r.jsxs)("button",{onClick:()=>window.location.href="/api/auth/google",className:"w-full py-3 px-4 rounded-lg border border-gray-700 bg-gray-700 hover:bg-gray-600 transition-colors flex items-center justify-center",children:[(0,r.jsx)("svg",{className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",children:(0,r.jsxs)("g",{transform:"matrix(1, 0, 0, 1, 27.009001, -39.238998)",children:[(0,r.jsx)("path",{fill:"#4285F4",d:"M -3.264 51.509 C -3.264 50.719 -3.334 49.969 -3.454 49.239 L -14.754 49.239 L -14.754 53.749 L -8.284 53.749 C -8.574 55.229 -9.424 56.479 -10.684 57.329 L -10.684 60.329 L -6.824 60.329 C -4.564 58.239 -3.264 55.159 -3.264 51.509 Z"}),(0,r.jsx)("path",{fill:"#34A853",d:"M -14.754 63.239 C -11.514 63.239 -8.804 62.159 -6.824 60.329 L -10.684 57.329 C -11.764 58.049 -13.134 58.489 -14.754 58.489 C -17.884 58.489 -20.534 56.379 -21.484 53.529 L -25.464 53.529 L -25.464 56.619 C -23.494 60.539 -19.444 63.239 -14.754 63.239 Z"}),(0,r.jsx)("path",{fill:"#FBBC05",d:"M -21.484 53.529 C -21.734 52.809 -21.864 52.039 -21.864 51.239 C -21.864 50.439 -21.724 49.669 -21.484 48.949 L -21.484 45.859 L -25.464 45.859 C -26.284 47.479 -26.754 49.299 -26.754 51.239 C -26.754 53.179 -26.284 54.999 -25.464 56.619 L -21.484 53.529 Z"}),(0,r.jsx)("path",{fill:"#EA4335",d:"M -14.754 43.989 C -12.984 43.989 -11.404 44.599 -10.154 45.789 L -6.734 42.369 C -8.804 40.429 -11.514 39.239 -14.754 39.239 C -19.444 39.239 -23.494 41.939 -25.464 45.859 L -21.484 48.949 C -20.534 46.099 -17.884 43.989 -14.754 43.989 Z"})]})}),"Google"]})})]})]})}),(0,r.jsx)("div",{className:"mt-8 text-center",children:(0,r.jsx)(n(),{href:"/",className:"text-gray-400 hover:text-white transition-colors",children:"← Quay lại trang chủ"})})]})})}function h(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-pulse text-2xl font-bold mb-4",children:"Đang tải..."}),(0,r.jsx)("div",{className:"w-12 h-12 border-t-4 border-blue-500 border-solid rounded-full animate-spin mx-auto"})]})}),children:(0,r.jsx)(o,{})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[493,794,441,684,358],()=>s(455)),_N_E=e.O()}]);