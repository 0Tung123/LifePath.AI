"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[364],{1762:(e,a,t)=>{t.d(a,{I:()=>i,S:()=>l});var r=t(5155),o=t(2115),s=t(5327),n=t(5541);let c=(0,o.createContext)(void 0),l=e=>{let{children:a}=e,[t,l]=(0,o.useState)([]),[i,u]=(0,o.useState)(null),[d,h]=(0,o.useState)(!1),[g,y]=(0,o.useState)([]),[w,m]=(0,o.useState)(null),[f,p]=(0,o.useState)(!1),[A,S]=(0,o.useState)(null),[v,C]=(0,o.useState)([]),[b,k]=(0,o.useState)([]),[N,I]=(0,o.useState)(null);(0,o.useEffect)(()=>{E()},[]);let P=async()=>{try{h(!0);let e=await s.bX.getCharacters();l(e),I(null)}catch(e){console.error("Failed to fetch characters:",e),I((0,n.u)(e))}finally{h(!1)}},F=async e=>{try{h(!0);let a=await s.bX.getCharacterById(e);return I(null),a}catch(a){throw console.error("Failed to fetch character with id ".concat(e,":"),a),I((0,n.u)(a)),a}finally{h(!1)}},G=async e=>{try{h(!0);let a=await s.bX.createCharacter(e);return l(e=>[...e,a]),I(null),a}catch(e){throw console.error("Failed to create character:",e),I((0,n.u)(e)),e}finally{h(!1)}},X=async e=>{try{h(!0);let a=await s.bX.generateCharacter(e);return l(e=>[...e,a]),I(null),a}catch(e){throw console.error("Failed to generate character:",e),I((0,n.u)(e)),e}finally{h(!1)}},E=async()=>{try{let e=await s.bX.getAvailableGenres();k(e),I(null)}catch(e){console.error("Failed to fetch genres:",e),I((0,n.u)(e))}},x=async()=>{try{p(!0);let e=await s.bX.getGameSessions();y(e),I(null)}catch(e){console.error("Failed to fetch game sessions:",e),I((0,n.u)(e))}finally{p(!1)}},Q=async e=>{try{p(!0);let a=await s.bX.getGameSession(e);return m(a),a.currentStoryNode&&S(a.currentStoryNode),a.previousNodes&&C(a.previousNodes),I(null),a}catch(a){throw console.error("Failed to fetch game session with id ".concat(e,":"),a),I((0,n.u)(a)),a}finally{p(!1)}},Z=async e=>{try{p(!0);let a=await s.bX.startNewGame(e);return m(a),a.currentStoryNode&&S(a.currentStoryNode),C([]),I(null),a}catch(e){throw console.error("Failed to start new game:",e),I((0,n.u)(e)),e}finally{p(!1)}},R=async e=>{try{p(!0);let a=await s.bX.saveGame(e);return I(null),a}catch(a){throw console.error("Failed to save game session ".concat(e,":"),a),I((0,n.u)(a)),a}finally{p(!1)}},U=async e=>{try{p(!0);let a=await s.bX.endGame(e);return w&&w.id===e&&m(a),I(null),a}catch(a){throw console.error("Failed to end game session ".concat(e,":"),a),I((0,n.u)(a)),a}finally{p(!1)}},L=async e=>{if(!w)return void I("No active game session");try{p(!0);let a=await s.bX.makeChoice(w.id,e);m(a),A&&C(e=>[...e,A]),a.currentStoryNode&&S(a.currentStoryNode),I(null)}catch(a){console.error("Failed to make choice ".concat(e,":"),a),I((0,n.u)(a))}finally{p(!1)}},O=async e=>{if(!w)return void I("No active game session");try{p(!0);let a=await s.bX.processUserInput(w.id,e);m(a),A&&C(e=>[...e,A]),a.currentStoryNode&&S(a.currentStoryNode),I(null)}catch(e){console.error("Failed to process user input:",e),I((0,n.u)(e))}finally{p(!1)}};return(0,r.jsx)(c.Provider,{value:{characters:t,selectedCharacter:i,loadingCharacters:d,gameSessions:g,currentSession:w,loadingSession:f,currentNode:A,previousNodes:v,availableGenres:b,error:N,fetchCharacters:P,fetchCharacterById:F,createCharacter:G,generateCharacter:X,fetchGenres:E,fetchGameSessions:x,fetchGameSession:Q,startNewGame:Z,saveGame:R,endGame:U,makeChoice:L,processUserInput:O,setSelectedCharacter:u,clearGameState:()=>{m(null),S(null),C([]),I(null)}},children:a})},i=()=>{let e=(0,o.useContext)(c);if(void 0===e)throw Error("useGame must be used within a GameProvider");return e}},2302:(e,a,t)=>{t.d(a,{A:()=>o});let r=t(3464).A.create({baseURL:"http://localhost:3000",headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{{let a=localStorage.getItem("token");a&&(e.headers.Authorization="Bearer ".concat(a))}return e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>(e.response&&401===e.response.status&&(localStorage.removeItem("token"),window.location.pathname.includes("/auth/login")||(window.location.href="/auth/login")),Promise.reject(e)));let o=r},5327:(e,a,t)=>{t.d(a,{ZQ:()=>o,_R:()=>s,bX:()=>n});var r=t(2302);let o={login:async e=>(await r.A.post("/auth/login",e)).data,register:async e=>(await r.A.post("/auth/register",e)).data,verifyEmail:async e=>(await r.A.get("/auth/verify-email?token=".concat(e))).data,resendVerification:async e=>(await r.A.post("/auth/resend-verification",{email:e})).data,forgotPassword:async e=>(await r.A.post("/auth/forgot-password",{email:e})).data,resetPassword:async e=>(await r.A.post("/auth/reset-password",e)).data,getCurrentUser:async()=>(await r.A.get("/user/profile")).data,logout:async()=>{localStorage.removeItem("token")},googleLogin:()=>{window.location.href="".concat("http://localhost:3000","/auth/google")},handleGoogleCallback:e=>{localStorage.setItem("token",e),window.location.href="/dashboard"}};var s=function(e){return e.FANTASY="fantasy",e.MODERN="modern",e.SCIFI="scifi",e.XIANXIA="xianxia",e.WUXIA="wuxia",e.HORROR="horror",e.CYBERPUNK="cyberpunk",e.STEAMPUNK="steampunk",e.POSTAPOCALYPTIC="postapocalyptic",e.HISTORICAL="historical",e}({});let n={createCharacter:async e=>(await r.A.post("/game/characters",e)).data,generateCharacter:async e=>(await r.A.post("/game/characters/generate",e)).data,getCharacters:async()=>(await r.A.get("/game/characters")).data,getCharacterById:async e=>(await r.A.get("/game/characters/".concat(e))).data,getAvailableGenres:async()=>(await r.A.get("/game/genres")).data,startNewGame:async e=>(await r.A.post("/game/sessions",{characterId:e})).data,getGameSessions:async()=>(await r.A.get("/game/sessions")).data,getGameSession:async e=>(await r.A.get("/game/sessions/".concat(e))).data,saveGame:async e=>(await r.A.put("/game/sessions/".concat(e,"/save"))).data,endGame:async e=>(await r.A.put("/game/sessions/".concat(e,"/end"))).data,makeChoice:async(e,a)=>(await r.A.post("/game/sessions/".concat(e,"/choices/").concat(a))).data,processUserInput:async(e,a)=>(await r.A.post("/game/sessions/".concat(e,"/input"),a)).data}},5541:(e,a,t)=>{t.d(a,{u:()=>o});var r=t(3464);function o(e){if(r.A.isAxiosError(e)){if(e.response){let a=e.response.data;return a.message?a.message:"Error ".concat(e.response.status,": ").concat(e.response.statusText)}return e.request&&!e.response?"Network error. Please check your internet connection and try again.":e.message}return e instanceof Error?e.message:"An unknown error occurred. Please try again."}},7182:(e,a,t)=>{t.d(a,{A:()=>i,O:()=>l});var r=t(5155),o=t(2115),s=t(5327),n=t(5541);let c=(0,o.createContext)(void 0),l=e=>{let{children:a}=e,[t,l]=(0,o.useState)(null),[i,u]=(0,o.useState)(!0),[d,h]=(0,o.useState)(null);(0,o.useEffect)(()=>{localStorage.getItem("token")?g():u(!1);let e=new URLSearchParams(window.location.search).get("token");"/auth/google-callback"===window.location.pathname&&e&&s.ZQ.handleGoogleCallback(e)},[]);let g=async()=>{try{u(!0);let e=await s.ZQ.getCurrentUser();l(e),h(null)}catch(e){console.error("Failed to fetch user profile:",e),h("Session expired. Please login again."),localStorage.removeItem("token")}finally{u(!1)}},y=async e=>{try{u(!0);let a=await s.ZQ.login(e);localStorage.setItem("token",a.access_token),await g(),h(null)}catch(e){throw console.error("Login failed:",e),h((0,n.u)(e)),e}finally{u(!1)}},w=async e=>{try{u(!0);let a=await s.ZQ.register(e);return h(null),a.message}catch(e){throw console.error("Registration failed:",e),h((0,n.u)(e)),e}finally{u(!1)}},m=async e=>{try{u(!0);let a=await s.ZQ.verifyEmail(e);return h(null),a.message}catch(e){throw console.error("Email verification failed:",e),h((0,n.u)(e)),e}finally{u(!1)}},f=async e=>{try{u(!0);let a=await s.ZQ.resendVerification(e);return h(null),a.message}catch(e){throw console.error("Failed to resend verification email:",e),h((0,n.u)(e)),e}finally{u(!1)}},p=async e=>{try{u(!0);let a=await s.ZQ.forgotPassword(e);return h(null),a.message}catch(e){throw console.error("Failed to process forgot password request:",e),h((0,n.u)(e)),e}finally{u(!1)}},A=async e=>{try{u(!0);let a=await s.ZQ.resetPassword(e);return h(null),a.message}catch(e){throw console.error("Failed to reset password:",e),h((0,n.u)(e)),e}finally{u(!1)}};return(0,r.jsx)(c.Provider,{value:{user:t,isLoading:i,isAuthenticated:!!t&&t.isActive,error:d,login:y,register:w,logout:()=>{s.ZQ.logout(),l(null),h(null),window.location.href="/auth/login"},verifyEmail:m,resendVerification:f,forgotPassword:p,resetPassword:A,googleLogin:()=>{s.ZQ.googleLogin()}},children:a})},i=()=>{let e=(0,o.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}}]);